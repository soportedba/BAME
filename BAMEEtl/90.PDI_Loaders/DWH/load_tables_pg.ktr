<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>load_tables_pg</name>
    <description />
    <extended_description />
    <trans_version />
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
      <parameter>
        <name>FEC_FIN_ISO</name>
        <default_value>FEC_FIN_ISO</default_value>
        <description />
      </parameter>
      <parameter>
        <name>FEC_INI_ISO</name>
        <default_value>FEC_INI_ISO</default_value>
        <description />
      </parameter>
      <parameter>
        <name>NUM_ROWS</name>
        <default_value>NUM_ROWS</default_value>
        <description />
      </parameter>
      <parameter>
        <name>STA_TABLE</name>
        <default_value>sta_table</default_value>
        <description />
      </parameter>
      <parameter>
        <name>STA_TABLE_DDL</name>
        <default_value>sta_table_ddl</default_value>
        <description />
      </parameter>
      <parameter>
        <name>authdb</name>
        <default_value>authdb</default_value>
        <description />
      </parameter>
      <parameter>
        <name>database</name>
        <default_value>database</default_value>
        <description />
      </parameter>
      <parameter>
        <name>dmlquery</name>
        <default_value>dmlquery</default_value>
        <description />
      </parameter>
      <parameter>
        <name>ip</name>
        <default_value>ip</default_value>
        <description />
      </parameter>
      <parameter>
        <name>ipport</name>
        <default_value>ipport</default_value>
        <description />
      </parameter>
      <parameter>
        <name>password</name>
        <default_value>password</default_value>
        <description />
      </parameter>
      <parameter>
        <name>port</name>
        <default_value>port</default_value>
        <description />
      </parameter>
      <parameter>
        <name>provider</name>
        <default_value>provider</default_value>
        <description />
      </parameter>
      <parameter>
        <name>shard</name>
        <default_value>shard</default_value>
        <description />
      </parameter>
      <parameter>
        <name>source_id_column</name>
        <default_value>source_id_column</default_value>
        <description />
      </parameter>
      <parameter>
        <name>source_timestamp_column</name>
        <default_value>source_timestamp_column</default_value>
        <description />
      </parameter>
      <parameter>
        <name>username</name>
        <default_value>username</default_value>
        <description />
      </parameter>
      <parameter>
        <name>vcarga</name>
        <default_value>vcarga</default_value>
        <description />
      </parameter>
    </parameters>
    <log>
      <trans-log-table>
        <connection />
        <schema />
        <table />
        <size_limit_lines />
        <interval />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject />
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject />
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject />
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject />
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection />
        <schema />
        <table />
        <interval />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection />
      <table />
      <field />
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>4000000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>1000000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file />
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
      <slaveserver>
        <name>etl_master</name>
        <hostname>etlmaster</hostname>
        <port>20400</port>
        <webAppName />
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname />
        <proxy_port />
        <non_proxy_hosts />
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
      <slaveserver>
        <name>etlmaster</name>
        <hostname>etlmaster</hostname>
        <port>20400</port>
        <webAppName />
        <username>cluster</username>
        <password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password>
        <proxy_hostname />
        <proxy_port />
        <non_proxy_hosts />
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
    </slaveservers>
    <clusterschemas>
      <clusterschema>
        <name>ETL_CSIC</name>
        <base_port>99999</base_port>
        <sockets_buffer_size>2000</sockets_buffer_size>
        <sockets_flush_interval>5000</sockets_flush_interval>
        <sockets_compressed>Y</sockets_compressed>
        <dynamic>Y</dynamic>
        <slaveservers>
          <name>etl_master</name>
        </slaveservers>
      </clusterschema>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2013/10/18 20:30:57.177</created_date>
    <modified_user>-</modified_user>
    <modified_date>2013/10/18 20:30:57.177</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>Split in multiple ktrs for memory optimization</note>
      <xloc>643</xloc>
      <yloc>494</yloc>
      <width>269</width>
      <heigth>25</heigth>
      <fontname>Arial</fontname>
      <fontsize>10</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <connection>
    <name>BAME</name>
    <server>${IP_BAME}</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>${DATABASE_BAME}</database>
    <port>${PORT_BAME}</port>
    <username>${USER_BAME}</username>
    <password>${PASSWORD_BAME}</password>
    <servername />
    <data_tablespace />
    <index_tablespace />
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${PORT_BAME}</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Calculate_clones</from>
      <to>Clone row</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Clone row</from>
      <to>Parallelism 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Parallelism 2</from>
      <to>load_tables_pg.log.1</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Parallelism 2</from>
      <to>Switch / Case</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>data_types.details.pg</from>
      <to>Metadata.Injection.load_table.generic.PG</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / Case</from>
      <to>postgresql</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>data_types.details.dates.pg</from>
      <to>Metadata.Injection.load_table.generic.PG</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>postgresql</from>
      <to>Metadata.Injection.load_table.generic.PG</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Parallelism 2</from>
      <to>Row Normaliser</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Row Normaliser</from>
      <to>Metadata.Injection.load_table.generic.PG</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>readVariables</from>
      <to>Calculate_clones</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>Calculate_clones</name>
    <type>ScriptValueMod</type>
    <description />
    <distribute>N</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>var copies=getVariable("COPIES_READ",0);
var clones=0;
if (copies >= 2) { 
	clones=copies-1;
}
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>clones</name>
        <rename>clones</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>496</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Clone row</name>
    <type>CloneRow</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <nrclones>0</nrclones>
    <addcloneflag>Y</addcloneflag>
    <cloneflagfield>cloned</cloneflagfield>
    <nrcloneinfield>Y</nrcloneinfield>
    <nrclonefield>clones</nrclonefield>
    <addclonenum>Y</addclonenum>
    <clonenumfield>clone_number</clonenumfield>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>624</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Metadata.Injection.load_table.generic.PG</name>
    <type>MetaInject</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>${COPIES_READ}</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <specification_method>filename</specification_method>
    <trans_object_id />
    <trans_name />
    <filename>${dir}${file.separator}load_table.generic.rdbms.ktr</filename>
    <directory_path />
    <source_step />
    <source_output_fields>    </source_output_fields>
    <target_file />
    <no_execution>N</no_execution>
    <stream_source_step>postgresql</stream_source_step>
    <stream_target_step>generateConnectionData</stream_target_step>
    <mappings>
	<mapping>
        <target_step_name>Conversions</target_step_name>
        <target_attribute_key>FIELD_PRECISION</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>data_types.details.pg</source_step>
        <source_field>precision</source_field>
      </mapping>
      <mapping>
        <target_step_name>Mappings</target_step_name>
        <target_attribute_key>FIELD_TYPE</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>data_types.details.pg</source_step>
        <source_field>pdi_type</source_field>
      </mapping>
      <mapping>
        <target_step_name>Conversions</target_step_name>
        <target_attribute_key>META_CONVERSION_MASK</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>data_types.details.dates.pg</source_step>
        <source_field>data_type_format</source_field>
      </mapping>
      <mapping>
        <target_step_name>generateConnectionData</target_step_name>
        <target_attribute_key>NAME</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>Row Normaliser</source_step>
        <source_field>key</source_field>
      </mapping>
      <mapping>
        <target_step_name>generateConnectionData</target_step_name>
        <target_attribute_key>DATA_VALUE</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>Row Normaliser</source_step>
        <source_field>value</source_field>
      </mapping>
      <mapping>
        <target_step_name>Conversions</target_step_name>
        <target_attribute_key>META_NAME</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>data_types.details.dates.pg</source_step>
        <source_field>column_name_date</source_field>
      </mapping>
      <mapping>
        <target_step_name>Mappings</target_step_name>
        <target_attribute_key>FIELD_NAME</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>data_types.details.pg</source_step>
        <source_field>column_name</source_field>
      </mapping>
      <mapping>
        <target_step_name>Conversions</target_step_name>
        <target_attribute_key>FIELD_NAME</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>data_types.details.pg</source_step>
        <source_field>column_name</source_field>
      </mapping>
      <mapping>
        <target_step_name>Mappings</target_step_name>
        <target_attribute_key>FIELD_PATH</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>data_types.details.pg</source_step>
        <source_field>column_name_orig</source_field>
      </mapping>
      <mapping>
        <target_step_name>Conversions</target_step_name>
        <target_attribute_key>FIELD_RENAME</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>data_types.details.pg</source_step>
        <source_field>column_name</source_field>
      </mapping>
      <mapping>
        <target_step_name>write_sta_table</target_step_name>
        <target_attribute_key>TARGET_TABLE</target_attribute_key>
        <target_detail>N</target_detail>
        <source_step>Row Normaliser</source_step>
        <source_field>sta_table</source_field>
      </mapping>
      <mapping>
        <target_step_name>write_sta_table</target_step_name>
        <target_attribute_key>DATABASE_FIELD_NAME</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>data_types.details.pg</source_step>
        <source_field>column_name</source_field>
      </mapping>
      <mapping>
        <target_step_name>write_sta_table</target_step_name>
        <target_attribute_key>DATABASE_STREAM_NAME</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>data_types.details.pg</source_step>
        <source_field>column_name</source_field>
      </mapping>
      <mapping>
        <target_step_name>Mappings</target_step_name>
        <target_attribute_key>FIELD_LENGTH</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>data_types.details.pg</source_step>
        <source_field>character_maximum_length</source_field>
      </mapping>
      <mapping>
        <target_step_name>Conversions</target_step_name>
        <target_attribute_key>META_DATE_FORMAT_TIMEZONE</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>data_types.details.dates.pg</source_step>
        <source_field>data_type_zone</source_field>
      </mapping>
      <mapping>
        <target_step_name>generateConnectionData</target_step_name>
        <target_attribute_key>TYPE</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>Row Normaliser</source_step>
        <source_field>ftype</source_field>
      </mapping>
      <mapping>
        <target_step_name>Conversions</target_step_name>
        <target_attribute_key>META_TYPE</target_attribute_key>
        <target_detail>Y</target_detail>
        <source_step>data_types.details.dates.pg</source_step>
        <source_field>data_type_date</source_field>
      </mapping>
    </mappings>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>768</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Parallelism 2</name>
    <type>ScriptValueMod</type>
    <description />
    <distribute>N</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>var f_limit=num_rows;

if (clones>=1) {
	f_limit=ceil(num_rows/(clones+1));
}

var f_skip=(clone_number)*f_limit;

//Podr√≠a valer  para mongo, pero no para el restor de bbdd
//if (1*clones==1*clone_number) {
//	f_limit=0;
//}

// Type of variables to pass to injector step
var ftype='String';</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>f_skip</name>
        <rename>f_skip</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>f_limit</name>
        <rename>f_limit</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ftype</name>
        <rename>ftype</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>624</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Row Normaliser</name>
    <type>Normaliser</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <typefield>key</typefield>
    <fields>
      <field>
        <name>FEC_INI_ISO</name>
        <value>FEC_INI_ISO</value>
        <norm>value</norm>
      </field>
      <field>
        <name>FEC_FIN_ISO</name>
        <value>FEC_FIN_ISO</value>
        <norm>value</norm>
      </field>
      <field>
        <name>num_rows</name>
        <value>num_rows</value>
        <norm>value</norm>
      </field>
      <field>
        <name>sta_table_ddl</name>
        <value>sta_table_ddl</value>
        <norm>value</norm>
      </field>
      <field>
        <name>authdb</name>
        <value>authdb</value>
        <norm>value</norm>
      </field>
      <field>
        <name>database</name>
        <value>database</value>
        <norm>value</norm>
      </field>
      <field>
        <name>dmlquery</name>
        <value>dmlquery</value>
        <norm>value</norm>
      </field>
      <field>
        <name>ip</name>
        <value>ip</value>
        <norm>value</norm>
      </field>
      <field>
        <name>ipport</name>
        <value>ipport</value>
        <norm>value</norm>
      </field>
      <field>
        <name>password</name>
        <value>password</value>
        <norm>value</norm>
      </field>
      <field>
        <name>port</name>
        <value>port</value>
        <norm>value</norm>
      </field>
      <field>
        <name>provider</name>
        <value>provider</value>
        <norm>value</norm>
      </field>
      <field>
        <name>shard</name>
        <value>shard</value>
        <norm>value</norm>
      </field>
      <field>
        <name>source_timestamp_column</name>
        <value>source_timestamp_column</value>
        <norm>value</norm>
      </field>
      <field>
        <name>username</name>
        <value>username</value>
        <norm>value</norm>
      </field>
      <field>
        <name>vcarga</name>
        <value>vcarga</value>
        <norm>value</norm>
      </field>
      <field>
        <name>clones</name>
        <value>clones</value>
        <norm>value</norm>
      </field>
      <field>
        <name>cloned</name>
        <value>cloned</value>
        <norm>value</norm>
      </field>
      <field>
        <name>clone_number</name>
        <value>clone_number</value>
        <norm>value</norm>
      </field>
      <field>
        <name>f_limit</name>
        <value>f_limit</value>
        <norm>value</norm>
      </field>
      <field>
        <name>f_skip</name>
        <value>f_skip</value>
        <norm>value</norm>
      </field>
    </fields>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>316</xloc>
      <yloc>208</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Switch / Case</name>
    <type>SwitchCase</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <fieldname>provider</fieldname>
    <use_contains>Y</use_contains>
    <case_value_type>String</case_value_type>
    <case_value_format />
    <case_value_decimal />
    <case_value_group />
    <default_target_step />
    <cases>
      <case>
        <value>postgresql</value>
        <target_step>postgresql</target_step>
      </case>
    </cases>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>624</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>data_types.details.dates.pg</name>
    <type>TableInput</type>
    <description />
    <distribute>N</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>BAME</connection>
    <sql>SELECT 
column_name as column_name_date,
'Date' as data_type_date,
'yyyy-MM-dd HH:mm:ss.SSS' as data_type_format,
'UTC' as data_type_zone
from information_schema.columns where table_name=lower('${STA_TABLE}') and substr(data_type,1,9) ='timestamp'
</sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>992</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>data_types.details.pg</name>
    <type>TableInput</type>
    <description />
    <distribute>N</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>BAME</connection>
    <sql>SELECT 	
(case 
	when column_name='aud_fec' then '${source_timestamp_column}'
	when column_name='_id' then '${source_id_column}'
	else column_name 
end) as column_name_orig,
(case 
		when data_type ='character varying' then 'String' 
		when data_type in ('int','integer','bigint','double precision') then 'Number' 
		when substr(data_type,1,9) ='timestamp' then 'String' 
	end) as pdi_type,
	(case 
		when substr(data_type,1,9) ='timestamp' then null
		else null
	end) as pdi_format,
column_name, data_type,character_maximum_length,10 as precision from information_schema.columns where table_name=lower('${STA_TABLE}')
</sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>768</xloc>
      <yloc>240</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>load_tables_pg.log.1</name>
    <type>WriteToLog</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <loglevel>log_level_debug</loglevel>
    <displayHeader>Y</displayHeader>
    <limitRows>N</limitRows>
    <limitRowsNumber>0</limitRowsNumber>
    <logmessage />
    <fields>
      </fields>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>224</xloc>
      <yloc>768</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>postgresql</name>
    <type>Dummy</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>400</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>readVariables</name>
    <type>GetVariable</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <fields>
      <field>
        <name>FEC_INI_ISO</name>
        <variable>${FEC_INI_ISO}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>FEC_FIN_ISO</name>
        <variable>${FEC_FIN_ISO}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>sta_table</name>
        <variable>${STA_TABLE}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>num_rows</name>
        <variable>${NUM_ROWS}</variable>
        <type>Integer</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>sta_table_ddl</name>
        <variable>${STA_TABLE_DDL}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>authdb</name>
        <variable>${authdb}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>database</name>
        <variable>${database}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>dmlquery</name>
        <variable>${dmlquery}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>ip</name>
        <variable>${ip}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>ipport</name>
        <variable>${ipport}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>password</name>
        <variable>${password}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>port</name>
        <variable>${port}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>provider</name>
        <variable>${provider}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>shard</name>
        <variable>${shard}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>source_timestamp_column</name>
        <variable>${source_timestamp_column}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>username</name>
        <variable>${username}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>vcarga</name>
        <variable>${vcarga}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>source_id_column</name>
        <variable>${source_id_column}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
    </fields>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>48</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
